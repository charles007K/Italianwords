<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="it" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quaderno di Vocaboli ğŸ“š</title>
    <link rel="stylesheet" href="input-style.css">
    <style>
        :root[data-theme='light'] {
            --bg-color: #f7f9fc;
            --text-color: #000;
            --container-bg: #fff;
            --border-color: #e0e0e0;
            --btn-primary: #4caf50;
            --btn-primary-hover: #45a049;
            --btn-secondary: #ff9800;
            --btn-tertiary: #2196F3;
            --btn-tertiary-hover: #0b7dda;
            --progress-bg: #e0e0e0;
            --progress-fill: #4caf50;
            --correct-color: #4caf50;
            --incorrect-color: #f44336;
            --input-bg: linear-gradient(45deg, rgba(255, 255, 255, 0.1), rgba(255, 182, 193, 0.1));
            --input-text: #000;
            --input-glow: rgba(255, 165, 0, 0.7);
        }
        
        :root[data-theme='dark'] {
            --bg-color: #121212;
            --text-color: #eee;
            --container-bg: #1e1e1e;
            --border-color: #333;
            --btn-primary: #388e3c;
            --btn-primary-hover: #2e7d32;
            --btn-secondary: #e65100;
            --btn-tertiary: #0d47a1;
            --btn-tertiary-hover: #01579b;
            --progress-bg: #333;
            --progress-fill: #388e3c;
            --correct-color: #4caf50;
            --incorrect-color: #f44336;
            --input-bg: linear-gradient(45deg, rgba(30, 30, 30, 0.1), rgba(147, 112, 219, 0.1));
            --input-text: #eee;
            --input-glow: rgba(148, 0, 211, 0.7);
        }
        
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--bg-color);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .container {
            background-color: var(--container-bg);
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease;
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .progress-bar {
            height: 10px;
            background-color: var(--progress-bg);
            border-radius: 5px;
            margin-bottom: 20px;
            overflow: hidden;
            transition: background-color 0.3s ease;
        }
        .progress {
            height: 100%;
            background-color: var(--progress-fill);
            transition: width 0.3s ease, background-color 0.3s ease;
        }
        .progress-text {
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
        }
        .card {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            transition: border-color 0.3s ease;
        }
        .definition {
            font-size: 18px;
            margin-bottom: 20px;
        }
        .input-area {
            margin-bottom: 20px;
            position: relative;
        }
        .btn {
            background-color: var(--btn-primary);
            color: white;
            border: none;
            padding: 12px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 4px;
            width: 100%;
            transition: background-color 0.3s ease;
        }
        .btn:hover {
            background-color: var(--btn-primary-hover);
        }
        #skipBtn {
            background-color: var(--btn-secondary);
            margin-top: 10px;
        }
        .result {
            font-size: 18px;
            margin-top: 20px;
            text-align: center;
        }
        .correct {
            color: var(--correct-color);
        }
        .incorrect {
            color: var(--incorrect-color);
        }
        .summary {
            margin-top: 30px;
            text-align: center;
            display: none;
        }
        .restart-btn {
            background-color: var(--btn-tertiary);
            margin-top: 20px;
        }
        .restart-btn:hover {
            background-color: var(--btn-tertiary-hover);
        }
        .settings {
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
        }
        select, button {
            padding: 10px;
            font-size: 16px;
            border-radius: 4px;
            background-color: var(--container-bg);
            color: var(--text-color);
            border: 1px solid var(--border-color);
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        .theme-toggle button {
            margin-bottom: 20px;
            cursor: pointer;
        }
        .wrong-words {
            margin-top: 20px;
            text-align: left;
        }
        .wrong-words ul {
            list-style: none;
            padding: 0;
        }
        .wrong-words li {
            margin: 5px 0;
        }
        @media (max-width: 600px) {
            .settings {
                flex-direction: column;
            }
            .settings select {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="theme-toggle">
            <button onclick="toggleTheme()">ğŸŒ“ Toggle Theme</button>
        </div>

        <div style="text-align:center; margin-bottom: 20px;">
            <button onclick="location.href='traffic.html'" class="btn restart-btn">ğŸš— Vai a Guida Vocaboli</button>
          </div>
        <div class="header">
            <h1>Quaderno di Vocaboli ğŸ“š</h1>
            <div class="settings">
                <select id="groupSelect">
                    <option value="-1">Tutte le parole (235) ğŸŒ</option>
                    <option value="0">Gruppo 1 (12) ğŸ¥‡</option>
                    <option value="1">Gruppo 2 (12) ğŸ¥ˆ</option>
                    <option value="2">Gruppo 3 (12) ğŸ¥‰</option>
                    <option value="3">Gruppo 4 (12) â­</option>
                    <option value="4">Gruppo 5 (12) ğŸŒŸ</option>
                    <option value="5">Gruppo 6 (12) ğŸš€</option>
                    <option value="6">Gruppo 7 (12) ğŸ¯</option>
                    <option value="7">Gruppo 8 (12) ğŸ””</option>
                    <option value="8">Gruppo 9 (12) ğŸˆ</option>
                    <option value="9">Gruppo 10 (12) ğŸ‰</option>
                    <option value="10">Gruppo 11 (12) ğŸ</option>
                    <option value="11">Gruppo 12 (12) ğŸŠ</option>
                    <option value="12">Gruppo 13 (12) ğŸ‹</option>
                    <option value="13">Gruppo 14 (12) ğŸ‰</option>
                    <option value="14">Gruppo 15 (12) ğŸ’</option>
                    <option value="15">Gruppo 16 (11) ğŸ“</option>
                    <option value="16">Gruppo 17 (11) ğŸ‡</option>
                    <option value="17">Gruppo 18 (11) ğŸ</option>
                    <option value="18">Gruppo 19 (11) ğŸ¥­</option>
                    <option value="19">Gruppo 20 (11) ğŸ¥‘</option>
                </select>
                <select id="modeSelect">
                    <option value="zh2en">Cinese â†’ Italiano ğŸ‡®ğŸ‡¹</option>
                    <option value="en2zh">Italiano â†’ Cinese ğŸ‡¨ğŸ‡³</option>
                </select>
            </div>
        </div>
        <div class="progress-bar">
            <div class="progress" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText"></div>
        
        <div class="card" id="wordCard">
            <div class="definition" id="definition"></div>
            <div class="input-area">
                <input type="text" id="wordInput" placeholder="Inserisci la risposta âœï¸" autocomplete="off">
            </div>
            <button class="btn" id="checkBtn">Controlla âœ…</button>
            <button class="btn" id="skipBtn">Salta â­ï¸</button>
            <div class="result" id="result"></div>
        </div>
        
        <div class="summary" id="summary">
            <h2>Completato! ğŸ‰</h2>
            <p>Il tuo punteggio: <span id="score"></span>/<span id="total"></span> ğŸ†</p>
            <div class="wrong-words" id="wrongWords"></div>
            <button class="btn restart-btn" id="restartBtn">Ricomincia ğŸ”„</button>
        </div>
    </div>

    <script>
        function toggleTheme() {
            const html = document.documentElement;
            html.dataset.theme = html.dataset.theme === 'dark' ? 'light' : 'dark';
            console.log("Tema cambiato a:", html.dataset.theme);
        }

        document.addEventListener("DOMContentLoaded", function() {
            const fadingElements = document.querySelectorAll('.card, .summary');
            fadingElements.forEach(el => {
                el.style.transition = 'opacity 0.5s ease';
            });
        });
    </script>

    <script>
        const wordGroups = [
            [
                { "en": "macchina", "zh": "æ±½è½¦" },
                { "en": "scuola", "zh": "å­¦æ ¡" },
                { "en": "lavoro", "zh": "å·¥ä½œ" },
                { "en": "casa", "zh": "æˆ¿å­" },
                { "en": "negozio", "zh": "å•†åº—" },
                { "en": "cibo", "zh": "é£Ÿç‰©" },
                { "en": "acqua", "zh": "æ°´" },
                { "en": "pane", "zh": "é¢åŒ…" },
                { "en": "latte", "zh": "ç‰›å¥¶" },
                { "en": "pomeriggio", "zh": "ä¸‹åˆ" },
                { "en": "sera", "zh": "æ™šä¸Š" },
                { "en": "oggi", "zh": "ä»Šå¤©" }
            ],
            [
                { "en": "ieri", "zh": "æ˜¨å¤©" },
                { "en": "domani", "zh": "æ˜å¤©" },
                { "en": "settimana", "zh": "æ˜ŸæœŸ" },
                { "en": "mese", "zh": "æœˆä»½" },
                { "en": "anno", "zh": "å¹´" },
                { "en": "minuto", "zh": "åˆ†é’Ÿ" },
                { "en": "secondo", "zh": "ç§’" },
                { "en": "chiave", "zh": "é’¥åŒ™" },
                { "en": "soldi", "zh": "é’±" },
                { "en": "banca", "zh": "é“¶è¡Œ" },
                { "en": "ospedale", "zh": "åŒ»é™¢" },
                { "en": "farmacia", "zh": "è¯åº—" }
            ],
            [
                { "en": "medico", "zh": "åŒ»ç”Ÿ" },
                { "en": "infermiere", "zh": "æŠ¤å£«" },
                { "en": "malattia", "zh": "ç–¾ç—…" },
                { "en": "febbre", "zh": "å‘çƒ§" },
                { "en": "dolore", "zh": "ç–¼ç—›" },
                { "en": "gatto", "zh": "çŒ«" },
                { "en": "uccello", "zh": "é¸Ÿ" },
                { "en": "formaggio", "zh": "å¥¶é…ª" },
                { "en": "frutta", "zh": "æ°´æœ" },
                { "en": "verdura", "zh": "è”¬èœ" },
                { "en": "telefono", "zh": "ç”µè¯" },
                { "en": "computer", "zh": "ç”µè„‘" }
            ],
            [
                { "en": "sedia", "zh": "æ¤…å­" },
                { "en": "tavolo", "zh": "æ¡Œå­" },
                { "en": "letto", "zh": "åºŠ" },
                { "en": "finestra", "zh": "çª—æˆ·" },
                { "en": "porta", "zh": "é—¨" },
                { "en": "colore", "zh": "é¢œè‰²" },
                { "en": "rosso", "zh": "çº¢è‰²" },
                { "en": "verde", "zh": "ç»¿è‰²" },
                { "en": "blu", "zh": "è“è‰²" },
                { "en": "giallo", "zh": "é»„è‰²" },
                { "en": "nero", "zh": "é»‘è‰²" },
                { "en": "bianco", "zh": "ç™½è‰²" }
            ],
            [
                { "en": "arancione", "zh": "æ©™è‰²" },
                { "en": "rosa", "zh": "ç²‰è‰²" },
                { "en": "grigio", "zh": "ç°è‰²" },
                { "en": "treno", "zh": "ç«è½¦" },
                { "en": "aereo", "zh": "é£æœº" },
                { "en": "autobus", "zh": "å…¬äº¤è½¦" },
                { "en": "bicicletta", "zh": "è‡ªè¡Œè½¦" },
                { "en": "metropolitana", "zh": "åœ°é“" },
                { "en": "biglietto", "zh": "ç¥¨" },
                { "en": "stazione", "zh": "è½¦ç«™" },
                { "en": "fermata", "zh": "ç«™ç‚¹" },
                { "en": "mappa", "zh": "åœ°å›¾" }
            ],
            [
                { "en": "hotel", "zh": "æ—…é¦†" },
                { "en": "orologio", "zh": "é’Ÿè¡¨" },
                { "en": "scarpe", "zh": "é‹å­" },
                { "en": "giacca", "zh": "å¤¹å…‹" },
                { "en": "camicia", "zh": "è¡¬è¡«" },
                { "en": "pantaloni", "zh": "è£¤å­" },
                { "en": "vestito", "zh": "è¿è¡£è£™" },
                { "en": "calze", "zh": "è¢œå­" },
                { "en": "occhiali", "zh": "çœ¼é•œ" },
                { "en": "borsa", "zh": "åŒ…" },
                { "en": "ombrello", "zh": "é›¨ä¼" },
                { "en": "marrone", "zh": "æ£•è‰²" }
            ],
            [
                { "en": "amico", "zh": "æœ‹å‹" },
                { "en": "persona", "zh": "äºº" },
                { "en": "bambino", "zh": "å°å­©" },
                { "en": "ragazzo", "zh": "ç”·å­©" },
                { "en": "ragazza", "zh": "å¥³å­©" },
                { "en": "donna", "zh": "å¥³äºº" },
                { "en": "uomo", "zh": "ç”·äºº" },
                { "en": "famiglia", "zh": "å®¶åº­" },
                { "en": "genitori", "zh": "çˆ¶æ¯" },
                { "en": "figlio", "zh": "å„¿å­" },
                { "en": "figlia", "zh": "å¥³å„¿" },
                { "en": "nonno", "zh": "çˆ·çˆ·" }
            ],
            [
                { "en": "nonna", "zh": "å¥¶å¥¶" },
                { "en": "zio", "zh": "å”å”" },
                { "en": "zia", "zh": "é˜¿å§¨" },
                { "en": "cugino", "zh": "å ‚å…„å¼Ÿ" },
                { "en": "cugina", "zh": "å ‚å§å¦¹" },
                { "en": "marito", "zh": "ä¸ˆå¤«" },
                { "en": "moglie", "zh": "å¦»å­" },
                { "en": "Intelligenza artificiale", "zh": "äººå·¥æ™ºèƒ½" },
                { "en": "E-commerce", "zh": "ç”µå­å•†åŠ¡" },
                { "en": "Pagamento online", "zh": "åœ¨çº¿æ”¯ä»˜" },
                { "en": "Forum", "zh": "è®ºå›" },
                { "en": "Influencer", "zh": "ç½‘çº¢" }
            ],
            [
                { "en": "Mi piace", "zh": "ç‚¹èµ" },
                { "en": "Commento", "zh": "è¯„è®º" },
                { "en": "Notifica", "zh": "é€šçŸ¥" },
                { "en": "Risoluzione", "zh": "åˆ†è¾¨ç‡" },
                { "en": "Pixelato", "zh": "é©¬èµ›å…‹åŒ–" },
                { "en": "pioggia", "zh": "é›¨" },
                { "en": "neve", "zh": "é›ª" },
                { "en": "vento", "zh": "é£" },
                { "en": "tempo", "zh": "å¤©æ°”" },
                { "en": "giorno", "zh": "æ—¥" },
                { "en": "notte", "zh": "å¤œ" },
                { "en": "mattina", "zh": "æ—©æ™¨" }
            ],
            [
                { "en": "nipote", "zh": "å­™å­/ä¾„å­" },
                { "en": "animale", "zh": "åŠ¨ç‰©" },
                { "en": "cane", "zh": "ç‹—" },
                { "en": "camera", "zh": "æˆ¿é—´" },
                { "en": "valigia", "zh": "è¡Œæ" },
                { "en": "documento", "zh": "è¯ä»¶" },
                { "en": "passaporto", "zh": "æŠ¤ç…§" },
                { "en": "vacanza", "zh": "å‡æœŸ" },
                { "en": "viaggio", "zh": "æ—…è¡Œ" },
                { "en": "mare", "zh": "æµ·" },
                { "en": "montagna", "zh": "å±±" },
                { "en": "spiaggia", "zh": "æ²™æ»©" },
            ],
            [
                { "en": "Gennaio", "zh": "ä¸€æœˆ" },
                { "en": "Febbraio", "zh": "äºŒæœˆ" },
                { "en": "Marzo", "zh": "ä¸‰æœˆ" },
                { "en": "Aprile", "zh": "å››æœˆ" },
                { "en": "Maggio", "zh": "äº”æœˆ" },
                { "en": "Giugno", "zh": "å…­æœˆ" },
                { "en": "Luglio", "zh": "ä¸ƒæœˆ" },
                { "en": "Agosto", "zh": "å…«æœˆ" },
                { "en": "Settembre", "zh": "ä¹æœˆ" },
                { "en": "Ottobre", "zh": "åæœˆ" },
                { "en": "Novembre", "zh": "åä¸€æœˆ" }
                { "en": "Dicembre", "zh": "åäºŒæœˆ" },
                
            ],
            [
                { "en": "sole", "zh": "å¤ªé˜³" },
                { "en": "Prezzo", "zh": "ä»·æ ¼" },
                { "en": "Contanti", "zh": "ç°é‡‘" },
                { "en": "Carta di credito", "zh": "ä¿¡ç”¨å¡" },
                { "en": "Scontrino", "zh": "å°ç¥¨" },
                { "en": "Ricevuta", "zh": "å‘ç¥¨" },
                { "en": "Offerta", "zh": "ç‰¹ä»· / ä¼˜æƒ " },
                { "en": "Sconto", "zh": "æŠ˜æ‰£" },
                { "en": "Taglia", "zh": "å°ºç ï¼ˆè¡£ç‰©ï¼‰" },
                { "en": "Misura", "zh": "å°ºå¯¸" },
                { "en": "Chilo", "zh": "åƒå…‹" },
                { "en": "Grammo", "zh": "å…‹" }
            ],
            [
                { "en": "Litro", "zh": "å‡" },
                { "en": "Pacco", "zh": "åŒ…ï¼ˆpackageï¼‰" },
                { "en": "Bottiglia", "zh": "ç“¶" },
                { "en": "Scatola", "zh": "ç›’å­" },
                { "en": "Barattolo", "zh": "ç½å­" },
                { "en": "Fresco", "zh": "æ–°é²œçš„" },
                { "en": "Correre", "zh": "è·‘" },
                { "en": "Camminare", "zh": "èµ°è·¯" },
                { "en": "Entrare", "zh": "è¿›å…¥" },
                { "en": "Uscire", "zh": "å‡ºå»" },
                { "en": "Salire", "zh": "ä¸Šå»" },
                { "en": "Scendere", "zh": "ä¸‹å»" }
            ],
            [
                { "en": "Portare", "zh": "å¸¦ã€æ‹¿" },
                { "en": "Mettere", "zh": "æ”¾ç½®" },
                { "en": "Aprire", "zh": "æ‰“å¼€" },
                { "en": "Chiudere", "zh": "å…³é—­" },
                { "en": "Pensare", "zh": "æ€è€ƒ" },
                { "en": "Sapere", "zh": "çŸ¥é“ï¼ˆto know a factï¼‰" },
                { "en": "Conoscere", "zh": "è®¤è¯†ã€äº†è§£ï¼ˆto be familiar withï¼‰" },
                { "en": "Capire", "zh": "æ˜ç™½ã€ç†è§£" },
                { "en": "Ricordare", "zh": "è®°å¾—" },
                { "en": "Dimenticare", "zh": "å¿˜è®°" },
                { "en": "Imparare", "zh": "å­¦ä¹ " },
                { "en": "Insegnare", "zh": "æ•™" }
            ],
            [
                { "en": "Decidere", "zh": "å†³å®š" },
                { "en": "Volere", "zh": "æƒ³è¦ï¼ˆto wantï¼‰" },
                { "en": "Parlare", "zh": "è¯´è¯" },
                { "en": "Chiedere", "zh": "è¯¢é—®" },
                { "en": "Rispondere", "zh": "å›ç­”" },
                { "en": "Telefonare", "zh": "æ‰“ç”µè¯" },
                { "en": "Scrivere", "zh": "å†™" },
                { "en": "Leggere", "zh": "è¯»" },
                { "en": "Ascoltare", "zh": "å¬" },
                { "en": "Spiegare", "zh": "è§£é‡Š" },
                { "en": "Ridere", "zh": "ç¬‘" },
                { "en": "Piangere", "zh": "å“­" }
            ],
            [
                { "en": "Dormire", "zh": "ç¡è§‰" },
                { "en": "Alzarsi", "zh": "èµ·åºŠï¼ˆåèº«åŠ¨è¯ï¼‰" },
                { "en": "Lavarsi", "zh": "æ´—æ¾¡ï¼ˆåèº«åŠ¨è¯ï¼‰" },
                { "en": "Vestirsi", "zh": "ç©¿è¡£ï¼ˆåèº«åŠ¨è¯ï¼‰" },
                { "en": "Comprare", "zh": "ä¹°" },
                { "en": "Pagare", "zh": "ä»˜æ¬¾" },
                { "en": "Lavorare", "zh": "å·¥ä½œ" },
                { "en": "Studiare", "zh": "å­¦ä¹ " },
                { "en": "Vivere", "zh": "ç”Ÿæ´» / å±…ä½" },
                { "en": "Amare", "zh": "çˆ±" },
                { "en": "Bello", "zh": "æ¼‚äº®çš„ / ç¾ä¸½çš„" }
            ],
            [
                { "en": "Brutto", "zh": "ä¸‘çš„ / ç³Ÿçš„" },
                { "en": "Grande", "zh": "å¤§çš„" },
                { "en": "Piccolo", "zh": "å°çš„" },
                { "en": "Alto", "zh": "é«˜çš„" },
                { "en": "Basso", "zh": "çŸ®çš„ / ä½çš„" },
                { "en": "Lungo", "zh": "é•¿çš„" },
                { "en": "Corto", "zh": "çŸ­çš„" },
                { "en": "Vecchio", "zh": "è€çš„ / æ—§çš„" },
                { "en": "Giovane", "zh": "å¹´è½»çš„" },
                { "en": "Intelligente", "zh": "èªæ˜çš„" },
                { "en": "Stupido", "zh": "æ„šè ¢çš„" }
            ],
            [
                { "en": "Gentile", "zh": "æœ‰ç¤¼è²Œçš„ / æ¸©å’Œçš„" },
                { "en": "Cattivo", "zh": "åçš„ / æ¶çš„" },
                { "en": "Buono", "zh": "å¥½çš„ / å–„è‰¯çš„" },
                { "en": "Triste", "zh": "æ‚²ä¼¤çš„" },
                { "en": "Felice", "zh": "å¿«ä¹çš„" },
                { "en": "Arrabbiato", "zh": "ç”Ÿæ°”çš„" },
                { "en": "Timido", "zh": "å®³ç¾çš„" },
                { "en": "Socievole", "zh": "å¤–å‘çš„" },
                { "en": "Stanco", "zh": "ç´¯çš„" },
                { "en": "Malato", "zh": "ç”Ÿç—…çš„" },
                { "en": "Caldo", "zh": "çƒ­çš„" }
            ],
            [
                { "en": "Freddo", "zh": "å†·çš„" },
                { "en": "Affamato", "zh": "é¥¿çš„" },
                { "en": "Assetato", "zh": "æ¸´çš„" },
                { "en": "Occupato", "zh": "å¿™çš„ / å æœ‰ /å ç”¨" },
                { "en": "Libero", "zh": "ç©ºé—²çš„" },
                { "en": "Pulito", "zh": "å¹²å‡€çš„" },
                { "en": "Sporco", "zh": "è„çš„" },
                { "en": "Facile", "zh": "ç®€å•çš„" },
                { "en": "Difficile", "zh": "å›°éš¾çš„" },
                { "en": "Veloce", "zh": "å¿«çš„" },
                { "en": "Lento", "zh": "æ…¢çš„" }
            ],
            [
                { "en": "Nuovo", "zh": "æ–°çš„" },
                { "en": "Antico", "zh": "å¤è€çš„" },
                { "en": "Importante", "zh": "é‡è¦çš„" },
                { "en": "Interessante", "zh": "æœ‰è¶£çš„" },
                { "en": "Noioso", "zh": "æ— èŠçš„" },
                { "en": "Utile", "zh": "æœ‰ç”¨çš„" },
                { "en": "Ricco", "zh": "å¯Œæœ‰çš„" },
                { "en": "Povero", "zh": "è´«ç©·çš„" },
                { "en": "Caro", "zh": "è´µçš„ / äº²çˆ±çš„" },
                { "en": "Economico", "zh": "å®æƒ çš„" },
                { "en": "Pronto", "zh": "å‡†å¤‡å¥½çš„" }
            ]
        ];

        // æ‰€æœ‰è¯æ±‡ï¼ˆç”¨äºâ€œå…¨éƒ¨è¯æ±‡â€æ¨¡å¼ï¼‰
        const allWords = wordGroups.flat();

        document.addEventListener('DOMContentLoaded', function() {
            // DOM å…ƒç´ 
            const groupSelect = document.getElementById('groupSelect');
            const modeSelect = document.getElementById('modeSelect');
            const definitionElement = document.getElementById('definition');
            const wordInput = document.getElementById('wordInput');
            const checkBtn = document.getElementById('checkBtn');
            const skipBtn = document.getElementById('skipBtn');
            const resultElement = document.getElementById('result');
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            const wordCard = document.getElementById('wordCard');
            const summaryElement = document.getElementById('summary');
            const scoreElement = document.getElementById('score');
            const totalElement = document.getElementById('total');
            const wrongWordsElement = document.getElementById('wrongWords');
            const restartBtn = document.getElementById('restartBtn');

            // çŠ¶æ€å˜é‡
            let words = [];
            let wordOrder = [];
            let currentWordIndex = 0;
            let correctCount = 0;
            let wrongWords = [];

            // Fisher-Yates æ´—ç‰Œç®—æ³•
            function shuffle(array) {
                const shuffled = [...array];
                for (let i = shuffled.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
                }
                return shuffled;
            }

            // æ›´æ–°è¯æ±‡åˆ—è¡¨
            function updateWords() {
                const groupIndex = parseInt(groupSelect.value);
                words = groupIndex === -1 ? allWords : wordGroups[groupIndex];
                wordOrder = shuffle([...Array(words.length).keys()]);
                currentWordIndex = 0;
                correctCount = 0;
                wrongWords = [];
                updateProgress();
                showNextWord();
                wordCard.style.display = 'block';
                summaryElement.style.display = 'none';
            }

            // æ˜¾ç¤ºä¸‹ä¸€ä¸ªå•è¯
            function showNextWord() {
                if (currentWordIndex >= words.length) {
                    finishGame();
                    return;
                }

                const wordIndex = wordOrder[currentWordIndex];
                const word = words[wordIndex];
                const mode = modeSelect.value;
                definitionElement.textContent = mode === 'zh2en' ? word.zh : word.en;
                wordInput.value = '';
                wordInput.placeholder = mode === 'zh2en' ? 'Inserisci in italiano âœï¸' : 'Inserisci in cinese âœï¸';
                resultElement.textContent = '';
                wordInput.focus();
            }

            // æ£€æŸ¥ç­”æ¡ˆ
            function checkAnswer() {
                const userInput = wordInput.value.trim().toLowerCase();
                const wordIndex = wordOrder[currentWordIndex];
                const word = words[wordIndex];
                const mode = modeSelect.value;
                const correctAnswer = mode === 'zh2en' ? word.en.toLowerCase() : word.zh;

                if (!userInput) {
                    resultElement.textContent = 'Inserisci una risposta â—';
                    resultElement.className = 'result incorrect';
                    // Trigger vibration for incorrect answer (100ms-50ms-100ms)
                    if ('vibrate' in navigator) {
                        navigator.vibrate([100, 50, 100]);
                    }
                    return;
                }

                if (userInput === correctAnswer) {
                    resultElement.textContent = 'Corretto! âœ…';
                    resultElement.className = 'result correct';
                    correctCount++;
                    currentWordIndex++;
                    updateProgress();
                    // Trigger vibration for correct answer (300ms)
                    if ('vibrate' in navigator) {
                        navigator.vibrate(300);
                    }
                    setTimeout(showNextWord, 1500);
                } else {
                    resultElement.textContent = `Sbagliato! ğŸ˜” La risposta corretta Ã¨: ${correctAnswer}`;
                    resultElement.className = 'result incorrect';
                    wrongWords.push({ question: mode === 'zh2en' ? word.zh : word.en, correct: correctAnswer, input: userInput });
                    // Trigger vibration for incorrect answer (100ms-50ms-100ms)
                    if ('vibrate' in navigator) {
                        navigator.vibrate([100, 50, 100]);
                    }
                }
            }

            // è·³åˆ°ä¸‹ä¸€ä¸ªå•è¯
            function skipWord() {
                const wordIndex = wordOrder[currentWordIndex];
                const word = words[wordIndex];
                const mode = modeSelect.value;
                wrongWords.push({ question: mode === 'zh2en' ? word.zh : word.en, correct: mode === 'zh2en' ? word.en : word.zh, input: 'Saltato â­ï¸' });
                currentWordIndex++;
                updateProgress();
                showNextWord();
            }

            // æ›´æ–°è¿›åº¦æ¡å’Œæ–‡æœ¬
            function updateProgress() {
                const progress = (currentWordIndex / words.length) * 100;
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `${currentWordIndex}/${words.length}`;
            }

            // å®Œæˆæ¸¸æˆ
            function finishGame() {
                wordCard.style.display = 'none';
                summaryElement.style.display = 'block';
                scoreElement.textContent = correctCount;
                totalElement.textContent = words.length;

                // Trigger special vibration if all answers are correct
                if ('vibrate' in navigator && correctCount === words.length) {
                    navigator.vibrate([200, 100, 200, 100, 400]);
                }

                // æ˜¾ç¤ºé”™é¢˜
                if (wrongWords.length > 0) {
                    wrongWordsElement.innerHTML = '<h3>Errori da rivedere: ğŸ“</h3><ul>' +
                        wrongWords.map(w => `<li>Domanda: ${w.question}, Risposta corretta: ${w.correct}, Tua risposta: ${w.input}</li>`).join('') +
                        '</ul>';
                } else {
                    wrongWordsElement.innerHTML = '<p>Tutto corretto! Nessun errore ğŸ˜Š</p>';
                }
            }

            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.dataset.theme = savedTheme;
            }
            function toggleTheme(){
                const html = document.documentElement;
                const newTheme = html.dataset.theme === 'dark' ? 'light' : 'dark';
                html.dataset.theme = newTheme;
                localStorage.setItem('theme', newTheme);
            }

            // äº‹ä»¶ç›‘å¬å™¨
            groupSelect.addEventListener('change', updateWords);
            modeSelect.addEventListener('change', updateWords);
            checkBtn.addEventListener('click', checkAnswer);
            skipBtn.addEventListener('click', skipWord);
            wordInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    checkAnswer();
                }
            });
            restartBtn.addEventListener('click', updateWords);

            // åˆå§‹åŒ–
            updateWords();
        });
    </script>
</body>
</html>
